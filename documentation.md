# Τεκμηρίωση Αλλαγών στον Κώδικα

## Εισαγωγή
Αυτό το έγγραφο περιγράφει τις αλλαγές που έγιναν στον κώδικα για την ολοκλήρωση του backend σύμφωνα με τις απαιτήσεις του PDF. Οι αλλαγές έγιναν με στόχο τη διατήρηση της απλότητας του κώδικα και την επίλυση των προβλημάτων που εντοπίστηκαν.

## Νέα Αρχεία
1. **MapReduceImplementation.java**: Υλοποίηση του μοντέλου MapReduce για την επεξεργασία δεδομένων.
2. **TestImplementation.java**: Κλάση για τον έλεγχο της υλοποίησης του backend.

## Τροποποιημένα Αρχεία

### 1. StoreData.java
- Προστέθηκαν σχόλια για καλύτερη κατανόηση του κώδικα
- Προστέθηκε μέθοδος `parseStoresJsonArray` για την ανάγνωση πολλαπλών καταστημάτων από ένα JSON αρχείο
- Βελτιώθηκε η μέθοδος `calculatePriceCategory` για τον υπολογισμό της κατηγορίας ακρίβειας
- Προστέθηκε έλεγχος για κενή λίστα προϊόντων

### 2. Store.java
- Βελτιώθηκε η μέθοδος `calculatePriceCategory` για να χειρίζεται την περίπτωση κενής λίστας προϊόντων

### 3. Actions.java
- Διορθώθηκε η λειτουργία αξιολόγησης καταστημάτων (rate) που έστελνε λάθος εντολή στον Worker
- Ενημερώθηκαν οι λειτουργίες filter, storeType και productCategory για να χρησιμοποιούν το νέο μοντέλο MapReduce
- Βελτιώθηκε ο χειρισμός σφαλμάτων σε όλες τις λειτουργίες

### 4. WorkerActions.java
- Διορθώθηκε η μέθοδος `AmountDec` για καλύτερο χειρισμό σφαλμάτων και έλεγχο ύπαρξης προϊόντων
- Βελτιώθηκε η λειτουργία αγοράς (purchase) για να επιτρέπει μόνο την αγορά ορατών προϊόντων (status="visible")

### 5. Manager.java
- Διορθώθηκε το πρόβλημα στην ανάγνωση των πεδίων "Available Amount" από το JSON

## Λεπτομέρειες Υλοποίησης

### MapReduce Framework
Το μοντέλο MapReduce υλοποιήθηκε με τις εξής λειτουργίες:
- **Map**: Κάθε Worker επεξεργάζεται τα δικά του δεδομένα και επιστρέφει μερικά αποτελέσματα
- **Reduce**: Ο Master συνδυάζει τα μερικά αποτελέσματα σε ένα τελικό αποτέλεσμα

Η κλάση `MapReduceImplementation` παρέχει τις εξής μεθόδους:
- `executeMapReduceSearch`: Για αναζήτηση καταστημάτων με φίλτρα
- `executeMapReduceStoreType`: Για συγκέντρωση πωλήσεων ανά τύπο καταστήματος
- `executeMapReduceProductCategory`: Για συγκέντρωση πωλήσεων ανά κατηγορία προϊόντος

### Συγχρονισμός και Πολυνηματικότητα
- Βελτιώθηκε ο συγχρονισμός στα σημεία όπου γίνονται ταυτόχρονες αγορές προϊόντων
- Χρησιμοποιήθηκε το keyword `synchronized` για την προστασία των κρίσιμων τμημάτων του κώδικα

### Διαχείριση JSON
- Διορθώθηκε η ανάγνωση των πεδίων από τα JSON αρχεία
- Προστέθηκε καλύτερος χειρισμός σφαλμάτων κατά την ανάγνωση των JSON αρχείων

### Διαχείριση Αποθέματος Προϊόντων
- Βελτιώθηκε η διαχείριση των προϊόντων που έχουν αφαιρεθεί (status="hidden")
- Προστέθηκε έλεγχος για την ύπαρξη προϊόντων πριν την αγορά

## Δοκιμές
Η κλάση `TestImplementation` παρέχει μεθόδους για τον έλεγχο των αλλαγών:
- `testPriceCategory`: Έλεγχος υπολογισμού κατηγορίας ακρίβειας
- `testJsonParsing`: Έλεγχος διαχείρισης JSON
- `testMapReduce`: Έλεγχος λειτουργίας MapReduce

## Συμπεράσματα
Οι αλλαγές που έγιναν βελτιώνουν σημαντικά τη λειτουργικότητα και την αξιοπιστία του backend. Ο κώδικας είναι τώρα πιο σταθερός, ακολουθεί καλύτερα τις προδιαγραφές του PDF και διαχειρίζεται σωστά τις περιπτώσεις σφαλμάτων.
